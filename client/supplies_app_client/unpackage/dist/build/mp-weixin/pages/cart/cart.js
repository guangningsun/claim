(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/cart"],{"055e":function(t,n,o){"use strict";o.r(n);var e=o("5890"),i=o.n(e);for(var a in e)"default"!==a&&function(t){o.d(n,t,(function(){return e[t]}))}(a);n["default"]=i.a},1973:function(t,n,o){"use strict";(function(t){o("0152"),o("921b");e(o("66fd"));var n=e(o("d0d1"));function e(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,o("543d")["createPage"])},"2c1c":function(t,n,o){"use strict";var e=o("8662"),i=o.n(e);i.a},5890:function(t,n,o){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(){o.e("node-modules/@dcloudio/uni-ui/lib/uni-fab/uni-fab").then(function(){return resolve(o("4cdd"))}.bind(null,o)).catch(o.oe)},i=function(){o.e("node-modules/@dcloudio/uni-ui/lib/uni-number-box/uni-number-box").then(function(){return resolve(o("ec1d"))}.bind(null,o)).catch(o.oe)},a={components:{uniNumberBox:i,uniFab:e},data:function(){return{modalName:null,reason:"",domain:getApp().globalData.domain,default_img:'this.src="'+o("7988")+'"',cartList:[],showEmpty:!1,directionStr:"垂直",horizontal:"right",vertical:"bottom",direction:"horizontal",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#0b988f",buttonColor:"#0b988f"},content:[{iconPath:"/static/submit1.png",selectedIconPath:"/static/submit1.png",text:"提交选择",active:!0}],catagory_num_limit:5,item_limit:5}},onLoad:function(){this.cartList=getApp().globalData.cart_list_info,this.showEmpty=!(this.cartList.length>0)},onHide:function(){},methods:{successCb:function(t){if(console.log("success cb"),0===t.data.error){var n=t.data.msg.asset_info,o=n.map((function(t,n,o){return Object.assign(t,{stock:n},{number:0})}));o.map((function(t){t.stock=parseInt(t.asset_count)})),console.log(o),this.cartList=o}},failCb:function(t){console.log("api_asset failed",t)},completeCb:function(t){},numberChange:function(t,n,o){this.cartList[o].number=t},showModal:function(t){this.modalName=t},hideModal:function(t){this.modalName=null},onConfirmReason:function(){this.submit(),this.reason=""},trigger:function(n){var o=this,e=this.cartList.filter((function(t){return t.number>0}));if(0!=e.length){for(var i=!1,a=0;a<e.length;a++)if(console.log("current number: "+this.cartList[a].number),console.log("lim num: "+e[a].asset_limit_nu),e[a].asset_limit_nu<this.cartList[a].number){i=!0;break}i?this.showModal("ReasonModal"):0===n.index?t.showModal({title:"提示",content:"是否申领选择的物品？",success:function(t){t.confirm?o.submit():t.cancel&&console.log("用户点击取消")}}):1===n.index&&t.navigateTo({url:"../history/history"})}else this.showToast("请选择物品数量")},successCallback:function(n){console.log("success cb"),0===n.data.error?(t.requestSubscribeMessage({tmplIds:["GOx_7a-j5CFw6kOHS9Z3H05LXmgNK8tudus9ud7c3ZU"],success:function(t){console.log("subscribe msg: "),console.log(t)}}),t.showToast({title:n.data.msg,complete:function(){getApp().globalData.cart_list_info=[],setTimeout((function(){t.navigateTo({url:"../category/category"})}),1500)}})):1===n.data.error&&this.showToast(n.data.msg)},failCallback:function(n){t.hideLoading(),console.log("api_claim_asset failed",n),this.showToast(n)},completeCallback:function(t){},getCartCataNum:function(){for(var t=0;t<this.cartList.length;t++)this.cartList[t]},submit:function(){var n=this.cartList.filter((function(t){return t.number>0}));if(0!=n.length){t.showLoading({title:"正在提交"});var o=t.getStorageSync("key_cat"),e=n.map((function(t){return Object.assign({claim_count:t.number},{claim_name:t.asset_name},{claim_unit:t.asset_unit},{id:t.id})}));console.log(e);var i={choose_list:JSON.stringify(e),category:o,reason:this.reason,claim_weixin_openid:t.getStorageSync("key_wx_openid")};this.requestWithMethod(getApp().globalData.api_claim_asset,"POST",i,this.successCallback,this.failCallback,this.completeCallback)}else this.showToast("请选择物品数量")}}};n.default=a}).call(this,o("543d")["default"])},8662:function(t,n,o){},bd04:function(t,n,o){"use strict";var e,i=function(){var t=this,n=t.$createElement;t._self._c},a=[];o.d(n,"b",(function(){return i})),o.d(n,"c",(function(){return a})),o.d(n,"a",(function(){return e}))},d0d1:function(t,n,o){"use strict";o.r(n);var e=o("bd04"),i=o("055e");for(var a in i)"default"!==a&&function(t){o.d(n,t,(function(){return i[t]}))}(a);o("2c1c");var s,c=o("f0c5"),u=Object(c["a"])(i["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],s);n["default"]=u.exports}},[["1973","common/runtime","common/vendor"]]]);